# Agent Tesla

_Malware profile by **[Mats Tesch](https://github.com/matstesch)** & **[Daniel Sadowski](https://github.com/ddotsadowski)**_

### Classification

| Virus | Worm | Trojan             | Ransomware | Botnet | Other |
| :---- | :--- | :----------------- | :--------- | :----- | :---- |
|       |      | :heavy_check_mark: |            |        |       |

### Facts & Figures

* **Year:** 2014 \[[^1]\]
* **Author:** Mustafa can Ozaydin \[[^2]\]
* **Language:** VB.NET \[[^4]\]
* **Infections:** 4,1% of cooperate networks \[[^3]\]
* **Damage:** unknown

### Description
_Agent Tesla_ is a remote access Trojan, or RAT for short, and thus falls into the category of Trojans. <br/>
It is believed to have been developed by a Turkish-born man named Mustafa can Ozaydin in 2014 and has been one of the most popular viruses ever since. <br/>
According to Cybercheck Security Report [^5], the virus managed to be the sixth most common malware in 2021. <br/>
After infecting a device, the Trojan collects sensitive information such as pressed keys, stored browser passwords, and the email clients of the user.<br/>
The GUI controllable tool is available online under a subscription model, which are tiered in a Bronze, Silver, Gold and a Platinum - each with different options to control third-party devices, as well as more extensive support.

### How does it work?
>The Agent Tesla malware primarily spreads through phishing emails. For this reason, it commonly receives a bump in prominence when new malspam campaigns are launched.
Once it gains access to a system, it uses various techniques to hide its presence. One is the use of multiple layers of packing and obfuscation to conceal the malicious functionality from detection. This makes it more difficult for signature-based detection systems to identify the malware because the main functionality is only revealed well after the initial infection.
After the core functionality has been unpacked, Agent Tesla searches for browsers installed on the system and extracts login credentials from them. It can also capture keystrokes and screenshots. All of these contribute to granting the attacker access to usersâ€™ accounts that are compromised by these stolen credentials.
The Agent Tesla malware has been observed in spear phishing campaigns against multiple different industries, including energy, logistics, finance, and government. [^6]

The tactics, techniques and procedures (_TTP_), of how the virus proceeds can be seen from the table below.

| Initial Access | Execution | Persistence | privilege Escalation | Defense Evasion | Credential Access | Discovery | Collection | Command and Control | Exfiltration |
| ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ | ------ |
| Phishing: Spear phishing Attachment **[(T1566.001)](https://attack.mitre.org/techniques/T1566/001/)** | Scheduled Task/ Job **[(T1053)](https://attack.mitre.org/techniques/T1053/)**	| Boot or Logon Autostart Execution **[(T1547)](https://attack.mitre.org/techniques/T1547/)** | Boot or Logon Autostart Execution **[(T1547)](https://attack.mitre.org/techniques/T1547/)** | Deobfuscate/ Decode Files or Information **[(T1140)](https://attack.mitre.org/techniques/T1140/)** | Credentials from Password Stores: Credentials from Web Browsers **[(T1555.003)](https://attack.mitre.org/techniques/T1555/003/)** | Account Discovery: Local Account **[(T1087.001)](https://attack.mitre.org/techniques/T1087/001/)** | Archive Collected Data **[(T1560)](https://attack.mitre.org/techniques/T1560/)** | Application Layer Protocol: Mail Protocols **[(T1071.003)](https://attack.mitre.org/techniques/T1071/003/)** | Exfiltration Over Alternative Protocol **[(T1048)](https://attack.mitre.org/techniques/T1048/)** 
|||| Process Injection **[(T1055)](https://attack.mitre.org/techniques/T1055/)** | Obfuscated Files or Information **[(T1027)](https://attack.mitre.org/techniques/T1027/)** | Input Capture: Keylogging **[(T1056.001)](https://attack.mitre.org/techniques/T1056/001/)** | System Information Discovery **[(T1082)](https://attack.mitre.org/techniques/T1082/)**	| Clipboard Data **[(T1115)](https://attack.mitre.org/techniques/T1115/)** | Application Layer Protocol: Web Protocols **[(T1071.001)](https://attack.mitre.org/techniques/T1071/001/)** ||
|||| Scheduled Task/ Job **[(T1053)](https://attack.mitre.org/techniques/T1053/)**	| Process Injection **[(T1055)](https://attack.mitre.org/techniques/T1055/)** | Unsecured Credentials: Credentials from Files **[(T1552.001)](https://attack.mitre.org/techniques/T1552/001/)** | System Network Configuration Discovery **[(T1016)](https://attack.mitre.org/techniques/T1016/)** | Input Capture: Keylogging **[(T1056.001)](https://attack.mitre.org/techniques/T1056/001/)** ||
||||||Unsecured Credentials: Credentials in Registry **[(T1552.002)](https://attack.mitre.org/techniques/T1552/002/)** | System Owner/ User Discovery **[(T1033)](https://attack.mitre.org/techniques/T1033/)** | Man in the Browser **[(T1185)](https://attack.mitre.org/techniques/T1185/)** |||
|||||||| Screen Capture **[(T1113)](https://attack.mitre.org/techniques/T1113/)** |||
|||||||| Video Capture **[(T1125)](https://attack.mitre.org/techniques/T1125/)** |||

*tablecontent: [^1]*

[^1]: https://blog.qualys.com/vulnerabilities-threat-research/2022/02/02/catching-the-rat-called-agent-tesla
[^2]: https://www.reliaquest.com/blog/malware-analysis-agent-tesla-defintion-enterprise-protection/#
[^3]: https://www.checkpoint.com/cyber-hub/threat-prevention/what-is-malware/agent-tesla-malware/#
[^4]: https://www.pcrisk.com/removal-guides/14767-agent-tesla-rat
[^5]: https://www.checkpoint.com/downloads/resources/cyber-security-report-2022.pdf
[^6]: https://www.checkpoint.com/cyber-hub/threat-prevention/what-is-malware/agent-tesla-malware/#